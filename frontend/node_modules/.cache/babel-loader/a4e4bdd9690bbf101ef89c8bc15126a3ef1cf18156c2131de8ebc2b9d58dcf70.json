{"ast":null,"code":"import{useState,useEffect,useContext}from\"react\";import{AuthContext}from\"../context/AuthContext\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function Reviews(_ref){let{id_producto}=_ref;const API_URL=process.env.REACT_APP_API_URL;const{usuario}=useContext(AuthContext);const[reviews,setReviews]=useState([]);const[comentario,setComentario]=useState(\"\");const[calificacion,setCalificacion]=useState(5);const obtenerReviews=async()=>{try{const res=await fetch(\"\".concat(API_URL,\"/api_reviews.php?id_producto=\").concat(id_producto));const data=await res.json();setReviews(data);}catch(err){console.error(\"Error cargando reseñas:\",err);}};useEffect(()=>{obtenerReviews();},[id_producto]);const enviarReview=async()=>{if(!usuario){alert(\"Debes iniciar sesión para dejar una reseña.\");return;}const datos={id_producto,id_usuario:usuario.id_usuario,calificacion,comentario};try{const res=await fetch(\"\".concat(API_URL,\"/api_reviews.php\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(datos)});const data=await res.json();if(data.success){setComentario(\"\");obtenerReviews();}else{alert(\"Error al guardar reseña\");}}catch(err){console.error(\"Error al enviar reseña:\",err);}};return/*#__PURE__*/_jsxs(\"article\",{className:\"art-review\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Rese\\xF1as\"}),/*#__PURE__*/_jsx(\"div\",{className:\"reviews-list\",children:reviews.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No hay rese\\xF1as todav\\xEDa.\"}):reviews.map(r=>/*#__PURE__*/_jsxs(\"div\",{className:\"review-tarjeta\",children:[/*#__PURE__*/_jsx(\"h3\",{children:/*#__PURE__*/_jsx(\"strong\",{children:r.nombre})}),/*#__PURE__*/_jsx(\"p\",{children:\"⭐\".repeat(r.calificacion)}),/*#__PURE__*/_jsx(\"p\",{children:r.comentario}),/*#__PURE__*/_jsx(\"span\",{children:r.fecha})]},r.id_review))}),/*#__PURE__*/_jsxs(\"div\",{className:\"review-form\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Agregar rese\\xF1a\"}),/*#__PURE__*/_jsx(\"label\",{children:\"Calificaci\\xF3n\"}),/*#__PURE__*/_jsxs(\"select\",{required:true,value:calificacion,onChange:e=>setCalificacion(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"5\",children:\"\\u2B50\\u2B50\\u2B50\\u2B50\\u2B50\"}),/*#__PURE__*/_jsx(\"option\",{value:\"4\",children:\"\\u2B50\\u2B50\\u2B50\\u2B50\"}),/*#__PURE__*/_jsx(\"option\",{value:\"3\",children:\"\\u2B50\\u2B50\\u2B50\"}),/*#__PURE__*/_jsx(\"option\",{value:\"2\",children:\"\\u2B50\\u2B50\"}),/*#__PURE__*/_jsx(\"option\",{value:\"1\",children:\"\\u2B50\"})]}),/*#__PURE__*/_jsx(\"label\",{children:\"Comentario\"}),/*#__PURE__*/_jsx(\"textarea\",{required:true,rows:\"3\",value:comentario,onChange:e=>setComentario(e.target.value)}),/*#__PURE__*/_jsx(\"button\",{onClick:enviarReview,children:\"Enviar Rese\\xF1a\"})]})]});}","map":{"version":3,"names":["useState","useEffect","useContext","AuthContext","jsx","_jsx","jsxs","_jsxs","Reviews","_ref","id_producto","API_URL","process","env","REACT_APP_API_URL","usuario","reviews","setReviews","comentario","setComentario","calificacion","setCalificacion","obtenerReviews","res","fetch","concat","data","json","err","console","error","enviarReview","alert","datos","id_usuario","method","headers","body","JSON","stringify","success","className","children","length","map","r","nombre","repeat","fecha","id_review","required","value","onChange","e","target","rows","onClick"],"sources":["C:/Users/jeduo/OneDrive/Documentos/Full Stack/proyectos react/proyecto-final/frontend/src/Components/Reviews.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\n\r\nexport default function Reviews({ id_producto }) {\r\n\r\n  const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n  const { usuario } = useContext(AuthContext);\r\n\r\n  const [reviews, setReviews] = useState([]);\r\n  const [comentario, setComentario] = useState(\"\");\r\n  const [calificacion, setCalificacion] = useState(5);\r\n\r\n  const obtenerReviews = async () => {\r\n    try {\r\n      const res = await fetch(`${API_URL}/api_reviews.php?id_producto=${id_producto}`);\r\n      const data = await res.json();\r\n      setReviews(data);\r\n    } catch (err) {\r\n      console.error(\"Error cargando reseñas:\", err);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    obtenerReviews();\r\n  }, [id_producto]);\r\n\r\n  const enviarReview = async () => {\r\n    if (!usuario) {\r\n      alert(\"Debes iniciar sesión para dejar una reseña.\");\r\n      return;\r\n    }\r\n\r\n    const datos = {\r\n      id_producto,\r\n      id_usuario: usuario.id_usuario,\r\n      calificacion,\r\n      comentario\r\n    };\r\n\r\n    try {\r\n      const res = await fetch(`${API_URL}/api_reviews.php`, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(datos)\r\n      });\r\n\r\n      const data = await res.json();\r\n\r\n      if (data.success) {\r\n        setComentario(\"\");\r\n        obtenerReviews();\r\n      } else {\r\n        alert(\"Error al guardar reseña\");\r\n      }\r\n\r\n    } catch (err) {\r\n      console.error(\"Error al enviar reseña:\", err);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <article className=\"art-review\">\r\n\r\n      <h2>Reseñas</h2>\r\n\r\n      <div className=\"reviews-list\">\r\n        {reviews.length === 0 ? (\r\n          <p>No hay reseñas todavía.</p>\r\n        ) : (\r\n          reviews.map(r => (\r\n            <div key={r.id_review} className=\"review-tarjeta\">\r\n              <h3><strong>{r.nombre}</strong></h3>\r\n              <p>{\"⭐\".repeat(r.calificacion)}</p>\r\n              <p>{r.comentario}</p>\r\n              <span>{r.fecha}</span>\r\n            </div>\r\n          ))\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"review-form\">\r\n        <h3>Agregar reseña</h3>\r\n\r\n        <label>Calificación</label>\r\n        <select required value={calificacion} onChange={e => setCalificacion(e.target.value)}>\r\n          <option value=\"5\">⭐⭐⭐⭐⭐</option>\r\n          <option value=\"4\">⭐⭐⭐⭐</option>\r\n          <option value=\"3\">⭐⭐⭐</option>\r\n          <option value=\"2\">⭐⭐</option>\r\n          <option value=\"1\">⭐</option>\r\n        </select>\r\n\r\n        <label>Comentario</label>\r\n        <textarea\r\n        required\r\n          rows=\"3\"\r\n          value={comentario}\r\n          onChange={e => setComentario(e.target.value)}\r\n        ></textarea>\r\n\r\n        <button onClick={enviarReview}>Enviar Reseña</button>\r\n      </div>\r\n\r\n    </article>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}