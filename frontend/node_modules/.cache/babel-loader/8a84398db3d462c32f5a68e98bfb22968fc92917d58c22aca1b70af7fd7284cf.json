{"ast":null,"code":"import\"../estilos/Perfil.css\";import{useContext,useEffect,useState}from\"react\";import{AuthContext}from\"../context/AuthContext\";import{Link}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Perfil(){const API_URL=process.env.REACT_APP_API_URL;const{usuario,logout}=useContext(AuthContext);const[pedidos,setPedidos]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{const fetchPedidos=async()=>{try{const response=await fetch(\"\".concat(API_URL,\"/historialPedidos.php?id_usuario=\").concat(usuario.id_usuario));const data=await response.json();setPedidos(data);}catch(error){console.error(\"Error al obtener pedidos:\",error);}finally{setLoading(false);}};if(usuario!==null&&usuario!==void 0&&usuario.id_usuario){fetchPedidos();}},[usuario]);return/*#__PURE__*/_jsx(\"main\",{className:\"perfil-main\",children:/*#__PURE__*/_jsxs(\"section\",{children:[/*#__PURE__*/_jsx(Link,{className:\"btn-logout\",to:\"/Login\",onClick:logout,children:\"Cerrar Sesi\\xF3n\"}),/*#__PURE__*/_jsx(Link,{to:\"/Login\",className:\"btn-login\",children:\"Iniciar Sesi\\xF3n\"}),/*#__PURE__*/_jsxs(\"article\",{className:\"contenedor_perfil\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"PERFIL DEL USUARIO\"}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",usuario===null||usuario===void 0?void 0:usuario.correo]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Nombre:\"}),\" \",usuario===null||usuario===void 0?void 0:usuario.nombre]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Cuenta:\"}),\" \",usuario===null||usuario===void 0?void 0:usuario.rol]})]}),/*#__PURE__*/_jsxs(\"article\",{className:\"historial_pedidos\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Historial de pedidos\"}),loading?/*#__PURE__*/_jsx(\"p\",{children:\"Cargando pedidos...\"}):pedidos.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-dark sin-pedidos\",role:\"alert\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Aviso !!!\"}),\" No tienes pedidos registrados todav\\xEDa.\"]}):/*#__PURE__*/_jsx(\"div\",{className:\"tabla-pedidos\",children:pedidos.map(pedido=>/*#__PURE__*/_jsxs(\"div\",{className:\"pedido-card\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"Codigo pedido #\",pedido.id_pedido]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"detalle-label\",children:\"Fecha:\"}),\" \",pedido.fecha_pedido]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"detalle-label\",children:\"Total:\"}),\" Q\",pedido.total]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"detalle-label\",children:\"Estado:\"}),\" \",pedido.estado]}),/*#__PURE__*/_jsx(\"h4\",{children:\"Detalles:\"}),/*#__PURE__*/_jsx(\"ul\",{children:pedido.detalles.map(d=>/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"detalle-label\",children:d.nombre}),\" x \",d.cantidad,\" \\u2014 Q\",d.subtotal]},d.id_dpedido))})]},pedido.id_pedido))})]})]})});}export default Perfil;","map":{"version":3,"names":["useContext","useEffect","useState","AuthContext","Link","jsx","_jsx","jsxs","_jsxs","Perfil","API_URL","process","env","REACT_APP_API_URL","usuario","logout","pedidos","setPedidos","loading","setLoading","fetchPedidos","response","fetch","concat","id_usuario","data","json","error","console","className","children","to","onClick","correo","nombre","rol","length","role","map","pedido","id_pedido","fecha_pedido","total","estado","detalles","d","cantidad","subtotal","id_dpedido"],"sources":["C:/Users/jeduo/OneDrive/Documentos/Full Stack/proyectos react/proyecto-final/frontend/src/paginas/Perfil.jsx"],"sourcesContent":["import \"../estilos/Perfil.css\";\r\nimport { useContext, useEffect, useState } from \"react\";\r\nimport { AuthContext } from \"../context/AuthContext\";\r\nimport { Link } from \"react-router-dom\";\r\n\r\nfunction Perfil() {\r\n\r\n  const API_URL = process.env.REACT_APP_API_URL;\r\n\r\n  const { usuario, logout } = useContext(AuthContext);\r\n  const [pedidos, setPedidos] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    const fetchPedidos = async () => {\r\n      try {\r\n        const response = await fetch(\r\n          `${API_URL}/historialPedidos.php?id_usuario=${usuario.id_usuario}`\r\n        );\r\n        const data = await response.json();\r\n        setPedidos(data);\r\n      } catch (error) {\r\n        console.error(\"Error al obtener pedidos:\", error);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    if (usuario?.id_usuario) {\r\n      fetchPedidos();\r\n    }\r\n  }, [usuario]);\r\n\r\n  return (\r\n    <main className=\"perfil-main\">\r\n      <section>\r\n        <Link className=\"btn-logout\" to=\"/Login\" onClick={logout}>Cerrar Sesión</Link>\r\n        <Link to=\"/Login\" className=\"btn-login\" >Iniciar Sesión</Link>\r\n        <article className=\"contenedor_perfil\">\r\n          <h1>PERFIL DEL USUARIO</h1>\r\n          <p><strong>Email:</strong> {usuario?.correo}</p>\r\n          <p><strong>Nombre:</strong> {usuario?.nombre}</p>\r\n          <p><strong>Cuenta:</strong> {usuario?.rol}</p>\r\n        </article>\r\n\r\n        <article className=\"historial_pedidos\">\r\n          <h2>Historial de pedidos</h2>\r\n          {loading ? (\r\n            <p>Cargando pedidos...</p>\r\n          ) : pedidos.length === 0 ? (\r\n            <div className=\"alert alert-dark sin-pedidos\" role=\"alert\">\r\n              <strong>Aviso !!!</strong> No tienes pedidos registrados todavía.\r\n            </div>\r\n          ) : (\r\n            <div className=\"tabla-pedidos\">\r\n              {pedidos.map((pedido) => (\r\n                <div key={pedido.id_pedido} className=\"pedido-card\">\r\n                  <h3>Codigo pedido #{pedido.id_pedido}</h3>\r\n                  <p><span className=\"detalle-label\">Fecha:</span> {pedido.fecha_pedido}</p>\r\n                  <p><span className=\"detalle-label\">Total:</span> Q{pedido.total}</p>\r\n                  <p><span className=\"detalle-label\">Estado:</span> {pedido.estado}</p>\r\n\r\n                  <h4>Detalles:</h4>\r\n                  <ul>\r\n                    {pedido.detalles.map((d) => (\r\n                      <li key={d.id_dpedido}>\r\n                        <span className=\"detalle-label\">{d.nombre}</span> x {d.cantidad} — Q{d.subtotal}\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </article>\r\n\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n\r\nexport default Perfil;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}